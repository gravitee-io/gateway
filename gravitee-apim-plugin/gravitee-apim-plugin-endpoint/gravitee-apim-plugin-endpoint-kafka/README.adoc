= Kafka Endpoint

[label label-enterprise]#This is an Enterprise feature#

== Description

This is an _OSS_ edition for Kafka endpoint which allow subscribing or publishing messages to a Kafka broker.

=== Quality Of Service

Better Quality Of Service are becoming available with this _Advanced_ version.

|===
|QoS           |  Delivery        | Description
|None          | Unwarranted      | Improve throughput by removing auto commit
|===

== Compatibility matrix

|===
|Plugin version | APIM version

|1.x and upper                  | 3.21.x to latest
|===

== Endpoint identifier

In order to use this _OSS_ version, you have to declare the following identifier `kafka` while configuring your API endpoints.

== Endpoint configuration

=== General configuration

==== Endpoint level configuration

|===
|Attributes | Default | Mandatory | Description

|bootstrapServers | N/A     | Yes | A coma-separated list of host and port pairs that are the addresses of the Kafka brokers in a "bootstrap" Kafka Cluster.
|===

==== Shared configuration

Shared configuration can be done directly from the endpoint group `sharedConfiguration` field.

If `inheritConfiguration` is false, then shared configuration can be overridden directly from endpoint `overriddenSharedConfiguration` field.

|===
|Attributes | Default | Mandatory | Description

|consumer | N/A     | No | The number of attempt to reconnect to the broker.
|producer | N/A     | No | Refers to an UTF-8 string that the broker uses to filter messages for each connected client.
|===

=== Consumer configuration

|===
|Attributes | Default | Mandatory | Description

|enabled | false     | No | Allows enabling or disabling the consumer capability.
|encodeMessageId | true     | No | Allows to encode the message id.
|autoOffsetReset | latest     | No | Defines consumer behaviour when consuming from a topic without an initial offset. Possible values are "latest" or "earliest"
|topics | N/A     | Yes | Refers to the list of topics to publish to or read from.
|===

=== Producer configuration
|===
|Attributes | Default | Mandatory | Description

|enabled | false     | No | Allow enabling or disabling the producer capability.
|topics | N/A     | Yes | Refers to the list of topics to publish to or read from.
|===

=== Examples

Bellow you will find a full mqtt endpoint configuration example:

```json
{
    "name": "default",
    "type": "kafka",
    "weight": 1,
    "inheritConfiguration": false,
    "configuration": {
        "identifier": "gio-apim-identifier",
        "serverHost": "localhost",
        "serverPort": "1883"
    },
    "sharedConfigurationOverride": {
            "consumer" : {
                "enabled": true,
                "topic": "kafka/topic"
            },
            "producer": {
                "enabled": false
            }
        }
}
```