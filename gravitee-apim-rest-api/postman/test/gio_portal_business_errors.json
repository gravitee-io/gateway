{
	"info": {
		"_postman_id": "c2c83ea2-6d75-407e-912c-f4fdbee683d2",
		"name": "Portal : Business Error",
		"description": "This collections contains requests to test business errors (no 401) on the Portal API",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "subscriptions",
			"item": [
				{
					"name": "400",
					"item": [
						{
							"name": "Input must not be null.",
							"item": [
								{
									"name": "POST /subscriptions",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "9527cdc2-318c-41f2-bd78-10aff2f37cb2",
												"exec": [
													"pm.test(\"Status code is 400\", function () {",
													"    pm.response.to.have.status(400);",
													"});",
													"",
													"pm.test(\"Input must not be null.\", function () {",
													"    var jsonData = pm.response.json();",
													"    pm.expect(jsonData.errors[0].message).to.eql(\"Input must not be null.\");",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"url": {
											"raw": "{{GRAVITEEIO_PORTAL_URL}}/subscriptions",
											"host": [
												"{{GRAVITEEIO_PORTAL_URL}}"
											],
											"path": [
												"subscriptions"
											]
										},
										"description": "Input must not be null"
									},
									"response": []
								}
							],
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "0473aef0-f7bf-4f54-b17a-1f5ebbe9848c",
										"type": "text/javascript",
										"exec": [
											""
										]
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "cb1a5be7-9762-44b9-aa8c-477125efb297",
										"type": "text/javascript",
										"exec": [
											""
										]
									}
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						},
						{
							"name": "'keyId' parameter does not correspond to the subscription",
							"item": [
								{
									"name": "-- Prepare --",
									"item": [
										{
											"name": "Create API for subscription",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "2a679288-3415-4977-b65d-bc81245d9627",
														"exec": [
															"pm.test(\"Status code is 201\", function () {",
															"    pm.response.to.have.status(201);",
															"});",
															"",
															"var jsonData = pm.response.json();",
															"pm.collectionVariables.set(\"created_api_for_sub\", JSON.stringify(jsonData));",
															"pm.collectionVariables.set(\"created_api_for_sub_id\", jsonData.id);"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "POST",
												"header": [
													{
														"key": "Content-Type",
														"name": "Content-Type",
														"value": "application/json",
														"type": "text"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\n\t\"name\":\"400API_SUB\",\n\t\"version\":\"1.0\",\n\t\"description\":\"API for 'Subscription' bad request\",\n\t\"contextPath\":\"/400apisub\",\n\t\"endpoint\":\"http://localhost\"\n}",
													"options": {
														"raw": {
															"language": "json"
														}
													}
												},
												"url": {
													"raw": "{{GRAVITEEIO_MGMT_URL}}/apis",
													"host": [
														"{{GRAVITEEIO_MGMT_URL}}"
													],
													"path": [
														"apis"
													]
												}
											},
											"response": []
										},
										{
											"name": "Publish created API",
											"event": [
												{
													"listen": "prerequest",
													"script": {
														"id": "ebb6519a-c9c6-4a53-8c3e-0da39f986a7d",
														"exec": [
															"var createdApi_for_sub_toPublish = JSON.parse(pm.collectionVariables.get(\"created_api_for_sub\"));",
															"createdApi_for_sub_toPublish.lifecycle_state='published';",
															"delete createdApi_for_sub_toPublish.id;",
															"delete createdApi_for_sub_toPublish.state;",
															"delete createdApi_for_sub_toPublish.created_at;",
															"delete createdApi_for_sub_toPublish.updated_at;",
															"delete createdApi_for_sub_toPublish.owner;",
															"delete createdApi_for_sub_toPublish.context_path;",
															"pm.collectionVariables.set(\"createdApi_for_sub_toPublish\", JSON.stringify(createdApi_for_sub_toPublish));",
															""
														],
														"type": "text/javascript"
													}
												},
												{
													"listen": "test",
													"script": {
														"id": "2958a753-39a2-4915-930b-7761a996621e",
														"exec": [
															"pm.test(\"Status code is 200\", function () {",
															"    pm.response.to.have.status(200);",
															"});"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "PUT",
												"header": [
													{
														"key": "Content-Type",
														"name": "Content-Type",
														"value": "application/json",
														"type": "text"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{{createdApi_for_sub_toPublish}}",
													"options": {
														"raw": {
															"language": "json"
														}
													}
												},
												"url": {
													"raw": "{{GRAVITEEIO_MGMT_URL}}/apis/:apiId",
													"host": [
														"{{GRAVITEEIO_MGMT_URL}}"
													],
													"path": [
														"apis",
														":apiId"
													],
													"variable": [
														{
															"key": "apiId",
															"value": "{{created_api_for_sub_id}}"
														}
													]
												}
											},
											"response": []
										},
										{
											"name": "Create Plan for subscription",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "d3390763-ceb4-4e79-9f7d-c6fdb4e49f62",
														"exec": [
															"pm.test(\"Status code is 201\", function () {",
															"    pm.response.to.have.status(201);",
															"});",
															"",
															"var jsonData = pm.response.json();",
															"pm.collectionVariables.set(\"created_plan_for_sub_id\", jsonData.id);"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "POST",
												"header": [
													{
														"key": "Content-Type",
														"name": "Content-Type",
														"value": "application/json",
														"type": "text"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\n\t\"name\":\"Plan_for_sub\",\n\t\"description\": \"a plan for Subscription bad request\"\n}",
													"options": {
														"raw": {
															"language": "json"
														}
													}
												},
												"url": {
													"raw": "{{GRAVITEEIO_MGMT_URL}}/apis/:apiId/plans",
													"host": [
														"{{GRAVITEEIO_MGMT_URL}}"
													],
													"path": [
														"apis",
														":apiId",
														"plans"
													],
													"variable": [
														{
															"key": "apiId",
															"value": "{{created_api_for_sub_id}}"
														}
													]
												}
											},
											"response": []
										},
										{
											"name": "Publish created Plan",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "f7606194-1da0-4b26-9400-3556659932f0",
														"exec": [
															"pm.test(\"Status code is 200\", function () {",
															"    pm.response.to.have.status(200);",
															"});"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "POST",
												"header": [
													{
														"key": "Content-Type",
														"name": "Content-Type",
														"type": "text",
														"value": "application/json"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\n\t\"name\":\"Plan_for_sub\",\n\t\"description\": \"a plan for Subscription bad request\"\n}",
													"options": {
														"raw": {
															"language": "json"
														}
													}
												},
												"url": {
													"raw": "{{GRAVITEEIO_MGMT_URL}}/apis/:apiId/plans/:planId/_publish",
													"host": [
														"{{GRAVITEEIO_MGMT_URL}}"
													],
													"path": [
														"apis",
														":apiId",
														"plans",
														":planId",
														"_publish"
													],
													"variable": [
														{
															"key": "apiId",
															"value": "{{created_api_for_sub_id}}"
														},
														{
															"key": "planId",
															"value": "{{created_plan_for_sub_id}}"
														}
													]
												}
											},
											"response": []
										},
										{
											"name": "Create Application for subscription",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "871c04a4-7e55-4aad-8046-e08f983a6290",
														"exec": [
															"pm.test(\"Status code is 201\", function () {",
															"    pm.response.to.have.status(201);",
															"});",
															"",
															"var jsonData = pm.response.json();",
															"pm.collectionVariables.set(\"created_application_for_sub_id\", jsonData.id);"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "POST",
												"header": [
													{
														"key": "Content-Type",
														"name": "Content-Type",
														"type": "text",
														"value": "application/json"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\n\t\"name\":\"400ApplicationSub\",\n\t\"description\":\"Application for 'Subscription bad request'\"\n}",
													"options": {
														"raw": {
															"language": "json"
														}
													}
												},
												"url": {
													"raw": "{{GRAVITEEIO_MGMT_URL}}/applications",
													"host": [
														"{{GRAVITEEIO_MGMT_URL}}"
													],
													"path": [
														"applications"
													]
												}
											},
											"response": []
										},
										{
											"name": "Create a first Subscription",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "2eafab0b-da96-4af8-8212-ccebfb4f1f18",
														"exec": [
															"pm.test(\"Status code is 201\", function () {",
															"    pm.response.to.have.status(201);",
															"});",
															"",
															"var jsonData = pm.response.json();",
															"pm.collectionVariables.set(\"created_sub_id\", jsonData.id);"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "POST",
												"header": [
													{
														"key": "Content-Type",
														"name": "Content-Type",
														"value": "application/json",
														"type": "text"
													}
												],
												"url": {
													"raw": "{{GRAVITEEIO_MGMT_URL}}/apis/:apiId/subscriptions?application={{created_application_for_sub_id}}&plan={{created_plan_for_sub_id}}",
													"host": [
														"{{GRAVITEEIO_MGMT_URL}}"
													],
													"path": [
														"apis",
														":apiId",
														"subscriptions"
													],
													"query": [
														{
															"key": "application",
															"value": "{{created_application_for_sub_id}}"
														},
														{
															"key": "plan",
															"value": "{{created_plan_for_sub_id}}"
														}
													],
													"variable": [
														{
															"key": "apiId",
															"value": "{{created_api_for_sub_id}}"
														}
													]
												}
											},
											"response": []
										},
										{
											"name": "Get subscription key",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "cc65c34d-d4e5-4c3f-82e7-9f3f2405e74d",
														"exec": [
															"pm.test(\"Status code is 200\", function () {",
															"    pm.response.to.have.status(200);",
															"});",
															"",
															"var jsonData = pm.response.json();",
															"pm.collectionVariables.set(\"first_sub_api_key\", jsonData[0].key);"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "GET",
												"header": [],
												"url": {
													"raw": "{{GRAVITEEIO_MGMT_URL}}/apis/:apiId/subscriptions/:subscriptionId/apikeys",
													"host": [
														"{{GRAVITEEIO_MGMT_URL}}"
													],
													"path": [
														"apis",
														":apiId",
														"subscriptions",
														":subscriptionId",
														"apikeys"
													],
													"variable": [
														{
															"key": "apiId",
															"value": "{{created_api_for_sub_id}}"
														},
														{
															"key": "subscriptionId",
															"value": "{{created_sub_id}}"
														}
													]
												}
											},
											"response": []
										},
										{
											"name": "Create a second Plan for subscription",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "e0765f26-1968-47e5-a381-d3fda075ad78",
														"exec": [
															"pm.test(\"Status code is 201\", function () {",
															"    pm.response.to.have.status(201);",
															"});",
															"",
															"var jsonData = pm.response.json();",
															"pm.collectionVariables.set(\"created_sec_plan_for_sub_id\", jsonData.id);"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "POST",
												"header": [
													{
														"key": "Content-Type",
														"name": "Content-Type",
														"type": "text",
														"value": "application/json"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\n\t\"name\":\"Plan_for_sub_2\",\n\t\"description\": \"another plan for Subscription bad request\"\n}",
													"options": {
														"raw": {
															"language": "json"
														}
													}
												},
												"url": {
													"raw": "{{GRAVITEEIO_MGMT_URL}}/apis/:apiId/plans",
													"host": [
														"{{GRAVITEEIO_MGMT_URL}}"
													],
													"path": [
														"apis",
														":apiId",
														"plans"
													],
													"variable": [
														{
															"key": "apiId",
															"value": "{{created_api_for_sub_id}}"
														}
													]
												}
											},
											"response": []
										},
										{
											"name": "Publish second created Plan",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "524a325d-2a4f-4253-9116-57dbe50adf39",
														"exec": [
															"pm.test(\"Status code is 200\", function () {",
															"    pm.response.to.have.status(200);",
															"});"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "POST",
												"header": [
													{
														"key": "Content-Type",
														"name": "Content-Type",
														"type": "text",
														"value": "application/json"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\n\t\"name\":\"Plan_for_sub2\",\n\t\"description\": \"a plan for Subscription bad request\"\n}",
													"options": {
														"raw": {
															"language": "json"
														}
													}
												},
												"url": {
													"raw": "{{GRAVITEEIO_MGMT_URL}}/apis/:apiId/plans/:planId/_publish",
													"host": [
														"{{GRAVITEEIO_MGMT_URL}}"
													],
													"path": [
														"apis",
														":apiId",
														"plans",
														":planId",
														"_publish"
													],
													"variable": [
														{
															"key": "apiId",
															"value": "{{created_api_for_sub_id}}"
														},
														{
															"key": "planId",
															"value": "{{created_sec_plan_for_sub_id}}"
														}
													]
												}
											},
											"response": []
										},
										{
											"name": "Create a second Subscription",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "e9ee7d5f-365a-4c80-a7c1-189ef7c06ab4",
														"exec": [
															"pm.test(\"Status code is 201\", function () {",
															"    pm.response.to.have.status(201);",
															"});",
															"",
															"var jsonData = pm.response.json();",
															"pm.collectionVariables.set(\"created_sec_sub_id\", jsonData.id);"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "POST",
												"header": [
													{
														"key": "Content-Type",
														"name": "Content-Type",
														"type": "text",
														"value": "application/json"
													}
												],
												"url": {
													"raw": "{{GRAVITEEIO_MGMT_URL}}/apis/:apiId/subscriptions?application={{created_application_for_sub_id}}&plan={{created_sec_plan_for_sub_id}}",
													"host": [
														"{{GRAVITEEIO_MGMT_URL}}"
													],
													"path": [
														"apis",
														":apiId",
														"subscriptions"
													],
													"query": [
														{
															"key": "application",
															"value": "{{created_application_for_sub_id}}"
														},
														{
															"key": "plan",
															"value": "{{created_sec_plan_for_sub_id}}"
														}
													],
													"variable": [
														{
															"key": "apiId",
															"value": "{{created_api_for_sub_id}}"
														}
													]
												}
											},
											"response": []
										}
									],
									"protocolProfileBehavior": {},
									"_postman_isSubFolder": true
								},
								{
									"name": "-- Test cases -- ",
									"item": [
										{
											"name": "POST /subscriptions/{subscriptionId}/keys/{keyId}/_revoke",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "57e463d2-7a79-479e-8181-a9a8f3f3a0ae",
														"exec": [
															"pm.test(\"Status code is 400\", function () {",
															"    pm.response.to.have.status(400);",
															"});",
															"pm.test(\"'keyId' parameter does not correspond to the subscription\", function () {",
															"    pm.expect(pm.response.text()).to.include(\"'keyId' parameter does not correspond to the subscription\");",
															"});"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "POST",
												"header": [],
												"url": {
													"raw": "{{GRAVITEEIO_PORTAL_URL}}/subscriptions/:subscriptionId/keys/:keyId/_revoke",
													"host": [
														"{{GRAVITEEIO_PORTAL_URL}}"
													],
													"path": [
														"subscriptions",
														":subscriptionId",
														"keys",
														":keyId",
														"_revoke"
													],
													"variable": [
														{
															"key": "subscriptionId",
															"value": "{{created_sec_sub_id}}"
														},
														{
															"key": "keyId",
															"value": "{{first_sub_api_key}}"
														}
													]
												}
											},
											"response": []
										}
									],
									"protocolProfileBehavior": {},
									"_postman_isSubFolder": true
								},
								{
									"name": "-- Clean up --",
									"item": [
										{
											"name": "Close subscription",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "5b31e873-5cca-4d50-927c-cf72663e181e",
														"exec": [
															"pm.test(\"Status code is 200\", function () {",
															"    pm.response.to.have.status(200);",
															"});"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "POST",
												"header": [],
												"url": {
													"raw": "{{GRAVITEEIO_MGMT_URL}}/apis/:apiId/subscriptions/:subscriptionId/status?status=CLOSED",
													"host": [
														"{{GRAVITEEIO_MGMT_URL}}"
													],
													"path": [
														"apis",
														":apiId",
														"subscriptions",
														":subscriptionId",
														"status"
													],
													"query": [
														{
															"key": "status",
															"value": "CLOSED"
														}
													],
													"variable": [
														{
															"key": "apiId",
															"value": "{{created_api_for_sub_id}}"
														},
														{
															"key": "subscriptionId",
															"value": "{{created_sub_id}}"
														}
													]
												}
											},
											"response": []
										},
										{
											"name": "Close second subscription",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "04bab463-a8ba-471c-ab98-30c1ac7d3276",
														"exec": [
															"pm.test(\"Status code is 200\", function () {",
															"    pm.response.to.have.status(200);",
															"});"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "POST",
												"header": [],
												"url": {
													"raw": "{{GRAVITEEIO_MGMT_URL}}/apis/:apiId/subscriptions/:subscriptionId/status?status=CLOSED",
													"host": [
														"{{GRAVITEEIO_MGMT_URL}}"
													],
													"path": [
														"apis",
														":apiId",
														"subscriptions",
														":subscriptionId",
														"status"
													],
													"query": [
														{
															"key": "status",
															"value": "CLOSED"
														}
													],
													"variable": [
														{
															"key": "apiId",
															"value": "{{created_api_for_sub_id}}"
														},
														{
															"key": "subscriptionId",
															"value": "{{created_sec_sub_id}}"
														}
													]
												}
											},
											"response": []
										},
										{
											"name": "Delete created application",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "db3b32ce-e54d-4718-91d1-ff023106f390",
														"exec": [
															"pm.test(\"Status code is 204\", function () {",
															"    pm.response.to.have.status(204);",
															"});"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "DELETE",
												"header": [],
												"url": {
													"raw": "{{GRAVITEEIO_MGMT_URL}}/applications/:applicationId",
													"host": [
														"{{GRAVITEEIO_MGMT_URL}}"
													],
													"path": [
														"applications",
														":applicationId"
													],
													"variable": [
														{
															"key": "applicationId",
															"value": "{{created_application_for_sub_id}}"
														}
													]
												}
											},
											"response": []
										},
										{
											"name": "Close created Plan",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "c4a3b51c-e72b-46b6-9d25-6cc070ed0fa9",
														"exec": [
															"pm.test(\"Status code is 200\", function () {",
															"    pm.response.to.have.status(200);",
															"});"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "POST",
												"header": [],
												"url": {
													"raw": "{{GRAVITEEIO_MGMT_URL}}/apis/:apiId/plans/:planId/_close",
													"host": [
														"{{GRAVITEEIO_MGMT_URL}}"
													],
													"path": [
														"apis",
														":apiId",
														"plans",
														":planId",
														"_close"
													],
													"variable": [
														{
															"key": "apiId",
															"value": "{{created_api_for_sub_id}}"
														},
														{
															"key": "planId",
															"value": "{{created_plan_for_sub_id}}"
														}
													]
												}
											},
											"response": []
										},
										{
											"name": "Close second created Plan",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "c3f962b7-c3ee-47c2-a2e3-4dd41dc8ed01",
														"exec": [
															"pm.test(\"Status code is 200\", function () {",
															"    pm.response.to.have.status(200);",
															"});"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "POST",
												"header": [],
												"url": {
													"raw": "{{GRAVITEEIO_MGMT_URL}}/apis/:apiId/plans/:planId/_close",
													"host": [
														"{{GRAVITEEIO_MGMT_URL}}"
													],
													"path": [
														"apis",
														":apiId",
														"plans",
														":planId",
														"_close"
													],
													"variable": [
														{
															"key": "apiId",
															"value": "{{created_api_for_sub_id}}"
														},
														{
															"key": "planId",
															"value": "{{created_sec_plan_for_sub_id}}"
														}
													]
												}
											},
											"response": []
										},
										{
											"name": "Delete created API",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "26760f61-a17b-4eec-8c62-f79dc37d4ba6",
														"exec": [
															"pm.test(\"Status code is 204\", function () {",
															"    pm.response.to.have.status(204);",
															"});"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "DELETE",
												"header": [],
												"url": {
													"raw": "{{GRAVITEEIO_MGMT_URL}}/apis/:apiId",
													"host": [
														"{{GRAVITEEIO_MGMT_URL}}"
													],
													"path": [
														"apis",
														":apiId"
													],
													"variable": [
														{
															"key": "apiId",
															"value": "{{created_api_for_sub_id}}"
														}
													]
												}
											},
											"response": []
										}
									],
									"protocolProfileBehavior": {},
									"_postman_isSubFolder": true
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				},
				{
					"name": "403",
					"item": [
						{
							"name": "-- Prepare --",
							"item": [
								{
									"name": "Create API for subscription",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "8f92b3fa-f8d3-42dd-a895-dd4e31d41e2a",
												"exec": [
													"pm.test(\"Status code is 201\", function () {",
													"    pm.response.to.have.status(201);",
													"});",
													"",
													"var jsonData = pm.response.json();",
													"pm.collectionVariables.set(\"created_api_for_sub\", JSON.stringify(jsonData));",
													"pm.collectionVariables.set(\"created_api_for_sub_id\", jsonData.id);"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"value": "application/json",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n\t\"name\":\"403API_SUB\",\n\t\"version\":\"1.0\",\n\t\"description\":\"API for Forbidden access to 'Subscription'\",\n\t\"contextPath\":\"/403apisub\",\n\t\"endpoint\":\"http://localhost\"\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{GRAVITEEIO_MGMT_URL}}/apis",
											"host": [
												"{{GRAVITEEIO_MGMT_URL}}"
											],
											"path": [
												"apis"
											]
										}
									},
									"response": []
								},
								{
									"name": "Publish created API",
									"event": [
										{
											"listen": "prerequest",
											"script": {
												"id": "4bda0f2f-38be-4074-af21-348eee3f43da",
												"exec": [
													"var createdApi_for_sub_toPublish = JSON.parse(pm.collectionVariables.get(\"created_api_for_sub\"));",
													"createdApi_for_sub_toPublish.lifecycle_state='published';",
													"delete createdApi_for_sub_toPublish.id;",
													"delete createdApi_for_sub_toPublish.state;",
													"delete createdApi_for_sub_toPublish.created_at;",
													"delete createdApi_for_sub_toPublish.updated_at;",
													"delete createdApi_for_sub_toPublish.owner;",
													"delete createdApi_for_sub_toPublish.context_path;",
													"pm.collectionVariables.set(\"createdApi_for_sub_toPublish\", JSON.stringify(createdApi_for_sub_toPublish));",
													""
												],
												"type": "text/javascript"
											}
										},
										{
											"listen": "test",
											"script": {
												"id": "4d58cd2b-c059-4646-bc3b-83fa0dff196f",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(200);",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "PUT",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"value": "application/json",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{{createdApi_for_sub_toPublish}}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{GRAVITEEIO_MGMT_URL}}/apis/:apiId",
											"host": [
												"{{GRAVITEEIO_MGMT_URL}}"
											],
											"path": [
												"apis",
												":apiId"
											],
											"variable": [
												{
													"key": "apiId",
													"value": "{{created_api_for_sub_id}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "Create Plan for subscription",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "60fd12e6-2b91-4fd5-82d2-b32b5754ceda",
												"exec": [
													"pm.test(\"Status code is 201\", function () {",
													"    pm.response.to.have.status(201);",
													"});",
													"",
													"var jsonData = pm.response.json();",
													"pm.collectionVariables.set(\"created_plan_for_sub_id\", jsonData.id);"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"value": "application/json",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n\t\"name\":\"Plan_for_sub\",\n\t\"description\": \"a plan for Forbidden access to Subscription\"\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{GRAVITEEIO_MGMT_URL}}/apis/:apiId/plans",
											"host": [
												"{{GRAVITEEIO_MGMT_URL}}"
											],
											"path": [
												"apis",
												":apiId",
												"plans"
											],
											"variable": [
												{
													"key": "apiId",
													"value": "{{created_api_for_sub_id}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "Publish created Plan",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "1cd3e0ea-e814-437c-87b9-1011ffdd4b01",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(200);",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n\t\"name\":\"Plan_for_sub\",\n\t\"description\": \"a plan for Forbidden access to Subscription not found\"\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{GRAVITEEIO_MGMT_URL}}/apis/:apiId/plans/:planId/_publish",
											"host": [
												"{{GRAVITEEIO_MGMT_URL}}"
											],
											"path": [
												"apis",
												":apiId",
												"plans",
												":planId",
												"_publish"
											],
											"variable": [
												{
													"key": "apiId",
													"value": "{{created_api_for_sub_id}}"
												},
												{
													"key": "planId",
													"value": "{{created_plan_for_sub_id}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "Create Application for subscription",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "e14f9c07-5260-4901-9f80-812a9a0d87b6",
												"exec": [
													"pm.test(\"Status code is 201\", function () {",
													"    pm.response.to.have.status(201);",
													"});",
													"",
													"var jsonData = pm.response.json();",
													"pm.collectionVariables.set(\"created_application_for_sub_id\", jsonData.id);"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n\t\"name\":\"403ApplicationSub\",\n\t\"description\":\"Application for 'Forbidden access to Subscription'\"\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{GRAVITEEIO_MGMT_URL}}/applications",
											"host": [
												"{{GRAVITEEIO_MGMT_URL}}"
											],
											"path": [
												"applications"
											]
										}
									},
									"response": []
								},
								{
									"name": "Create Subscription",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "dc221ded-b29b-40d5-be4d-b9e7fdce5c1f",
												"exec": [
													"pm.test(\"Status code is 201\", function () {",
													"    pm.response.to.have.status(201);",
													"});",
													"",
													"var jsonData = pm.response.json();",
													"pm.collectionVariables.set(\"created_sub_id\", jsonData.id);"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"value": "application/json",
												"type": "text"
											}
										],
										"url": {
											"raw": "{{GRAVITEEIO_MGMT_URL}}/apis/:apiId/subscriptions?application={{created_application_for_sub_id}}&plan={{created_plan_for_sub_id}}",
											"host": [
												"{{GRAVITEEIO_MGMT_URL}}"
											],
											"path": [
												"apis",
												":apiId",
												"subscriptions"
											],
											"query": [
												{
													"key": "application",
													"value": "{{created_application_for_sub_id}}"
												},
												{
													"key": "plan",
													"value": "{{created_plan_for_sub_id}}"
												}
											],
											"variable": [
												{
													"key": "apiId",
													"value": "{{created_api_for_sub_id}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "Get subscription key",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "66eb6f3a-8668-43d0-8267-826819ff806f",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(200);",
													"});",
													"",
													"var jsonData = pm.response.json();",
													"pm.collectionVariables.set(\"first_sub_api_key\", jsonData[0].key);"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{GRAVITEEIO_MGMT_URL}}/apis/:apiId/subscriptions/:subscriptionId/apikeys",
											"host": [
												"{{GRAVITEEIO_MGMT_URL}}"
											],
											"path": [
												"apis",
												":apiId",
												"subscriptions",
												":subscriptionId",
												"apikeys"
											],
											"variable": [
												{
													"key": "apiId",
													"value": "{{created_api_for_sub_id}}"
												},
												{
													"key": "subscriptionId",
													"value": "{{created_sub_id}}"
												}
											]
										}
									},
									"response": []
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						},
						{
							"name": "You do not have sufficient rights to access this resource",
							"item": [
								{
									"name": "GET /subscriptions - 2",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "782b052d-70f0-43bc-981d-c4c8160da74b",
												"exec": [
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{GRAVITEEIO_PORTAL_URL}}/subscriptions?applicationId={{created_application_for_sub_id}}",
											"host": [
												"{{GRAVITEEIO_PORTAL_URL}}"
											],
											"path": [
												"subscriptions"
											],
											"query": [
												{
													"key": "applicationId",
													"value": "{{created_application_for_sub_id}}"
												}
											]
										},
										"description": "With an Application Id but without APPLICATION_SUBSCRIPTION[READ]"
									},
									"response": []
								},
								{
									"name": "GET /subscriptions - 3",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "57bb3d77-39c8-4cb7-b4b7-dfa0ff3595aa",
												"exec": [
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{GRAVITEEIO_PORTAL_URL}}/subscriptions?applicationId={{created_application_for_sub_id}}&apiId={{created_api_for_sub_id}}",
											"host": [
												"{{GRAVITEEIO_PORTAL_URL}}"
											],
											"path": [
												"subscriptions"
											],
											"query": [
												{
													"key": "applicationId",
													"value": "{{created_application_for_sub_id}}"
												},
												{
													"key": "apiId",
													"value": "{{created_api_for_sub_id}}"
												}
											]
										},
										"description": "With an API Id and an Application Id but without API_SUBSCRIPTION[READ] and APPLICATION_SUBSCRIPTION[READ]"
									},
									"response": []
								},
								{
									"name": "POST /subscriptions",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "6b7ae58e-7a0d-4719-bc8a-f5eda20958c5",
												"exec": [
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n\t\"application\":\"{{created_application_for_sub_id}}\",\n\t\"plan\":\"{{created_plan_for_sub_id}}\",\n\t\"request\":\"for Subscription scenario\"\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{GRAVITEEIO_PORTAL_URL}}/subscriptions",
											"host": [
												"{{GRAVITEEIO_PORTAL_URL}}"
											],
											"path": [
												"subscriptions"
											]
										},
										"description": "APPLICATION_SUBSCRIPTION[CREATE]"
									},
									"response": []
								},
								{
									"name": "GET /subsciptions/:subscriptionId",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "7c502087-54f9-4556-bd45-5ccdbf9c800f",
												"exec": [
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{GRAVITEEIO_PORTAL_URL}}/subscriptions/:subscriptionId",
											"host": [
												"{{GRAVITEEIO_PORTAL_URL}}"
											],
											"path": [
												"subscriptions",
												":subscriptionId"
											],
											"variable": [
												{
													"key": "subscriptionId",
													"value": "{{created_sub_id}}"
												}
											]
										},
										"description": "API_SUBSCRIPTION[READ] or APPLICATION_SUBSCRIPTION[READ]"
									},
									"response": []
								},
								{
									"name": "POST /subscriptions/:subscriptionId/_close",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "da4e0b21-6993-4550-b4bd-d4078f083bf2",
												"exec": [
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"url": {
											"raw": "{{GRAVITEEIO_PORTAL_URL}}/subscriptions/:subscriptionId/_close",
											"host": [
												"{{GRAVITEEIO_PORTAL_URL}}"
											],
											"path": [
												"subscriptions",
												":subscriptionId",
												"_close"
											],
											"variable": [
												{
													"key": "subscriptionId",
													"value": "{{created_sub_id}}"
												}
											]
										},
										"description": "APPLICATION_SUBSCRIPTION[DELETE]"
									},
									"response": []
								},
								{
									"name": "POST /subscriptions/:subscriptionId/keys/_renew",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "b42efb4c-a810-48d0-ae29-4e83dc496dcf",
												"exec": [
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"url": {
											"raw": "{{GRAVITEEIO_PORTAL_URL}}/subscriptions/:subscriptionId/keys/_renew",
											"host": [
												"{{GRAVITEEIO_PORTAL_URL}}"
											],
											"path": [
												"subscriptions",
												":subscriptionId",
												"keys",
												"_renew"
											],
											"variable": [
												{
													"key": "subscriptionId",
													"value": "{{created_sub_id}}"
												}
											]
										},
										"description": "API_SUBSCRIPTION[UPDATE] or APPLICATION_SUBSCRIPTION[UPDATE]"
									},
									"response": []
								},
								{
									"name": "POST /subscriptions/:subscriptionId/keys/:keyId/_revoke",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "3487975d-ae7c-49fe-8ab5-4189c0e7b158",
												"exec": [
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"url": {
											"raw": "{{GRAVITEEIO_PORTAL_URL}}/subscriptions/:subscriptionId/keys/:keyId/_revoke",
											"host": [
												"{{GRAVITEEIO_PORTAL_URL}}"
											],
											"path": [
												"subscriptions",
												":subscriptionId",
												"keys",
												":keyId",
												"_revoke"
											],
											"variable": [
												{
													"key": "subscriptionId",
													"value": "{{created_sub_id}}"
												},
												{
													"key": "keyId",
													"value": "{{first_sub_api_key}}"
												}
											]
										},
										"description": "API_SUBSCRIPTION[UPDATE] or APPLICATION_SUBSCRIPTION[UPDATE]"
									},
									"response": []
								}
							],
							"auth": {
								"type": "basic",
								"basic": [
									{
										"key": "password",
										"value": "password",
										"type": "string"
									},
									{
										"key": "username",
										"value": "user",
										"type": "string"
									}
								]
							},
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "6634a7b4-56f2-49d3-b4e2-37cb43dfed1a",
										"type": "text/javascript",
										"exec": [
											""
										]
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "12b3e037-89a3-4b64-8ab7-172d17a0f8c6",
										"type": "text/javascript",
										"exec": [
											"pm.test(\"Status code is 403\", function () {",
											"    pm.response.to.have.status(403);",
											"});",
											"",
											"pm.test(\"You do not have sufficient rights to access this resource\", function () {",
											"    var jsonData = pm.response.json();",
											"    pm.expect(jsonData.errors[0].message).to.eql(\"You do not have sufficient rights to access this resource\");",
											"});"
										]
									}
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						},
						{
							"name": "-- Clean up --",
							"item": [
								{
									"name": "Close subscription",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "7f560503-5c7e-4842-9c0c-3e2abde84695",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(200);",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"url": {
											"raw": "{{GRAVITEEIO_MGMT_URL}}/apis/:apiId/subscriptions/:subscriptionId/status?status=CLOSED",
											"host": [
												"{{GRAVITEEIO_MGMT_URL}}"
											],
											"path": [
												"apis",
												":apiId",
												"subscriptions",
												":subscriptionId",
												"status"
											],
											"query": [
												{
													"key": "status",
													"value": "CLOSED"
												}
											],
											"variable": [
												{
													"key": "apiId",
													"value": "{{created_api_for_sub_id}}"
												},
												{
													"key": "subscriptionId",
													"value": "{{created_sub_id}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "Delete created application",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "cf887f7b-a6d0-4c00-af81-954795ded05d",
												"exec": [
													"pm.test(\"Status code is 204\", function () {",
													"    pm.response.to.have.status(204);",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "DELETE",
										"header": [],
										"url": {
											"raw": "{{GRAVITEEIO_MGMT_URL}}/applications/:applicationId",
											"host": [
												"{{GRAVITEEIO_MGMT_URL}}"
											],
											"path": [
												"applications",
												":applicationId"
											],
											"variable": [
												{
													"key": "applicationId",
													"value": "{{created_application_for_sub_id}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "Close created Plan",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "49090339-ad4c-4d01-8208-231a629259b3",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(200);",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"url": {
											"raw": "{{GRAVITEEIO_MGMT_URL}}/apis/:apiId/plans/:planId/_close",
											"host": [
												"{{GRAVITEEIO_MGMT_URL}}"
											],
											"path": [
												"apis",
												":apiId",
												"plans",
												":planId",
												"_close"
											],
											"variable": [
												{
													"key": "apiId",
													"value": "{{created_api_for_sub_id}}"
												},
												{
													"key": "planId",
													"value": "{{created_plan_for_sub_id}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "Delete created API",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "80d12f83-555f-4eb7-a364-6885d1d427a4",
												"exec": [
													"pm.test(\"Status code is 204\", function () {",
													"    pm.response.to.have.status(204);",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "DELETE",
										"header": [],
										"url": {
											"raw": "{{GRAVITEEIO_MGMT_URL}}/apis/:apiId",
											"host": [
												"{{GRAVITEEIO_MGMT_URL}}"
											],
											"path": [
												"apis",
												":apiId"
											],
											"variable": [
												{
													"key": "apiId",
													"value": "{{created_api_for_sub_id}}"
												}
											]
										}
									},
									"response": []
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				},
				{
					"name": "404",
					"item": [
						{
							"name": "-- Prepare --",
							"item": [
								{
									"name": "Create API for subscription",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "ee584555-0338-43b3-a7ea-9fd49ce8aed3",
												"exec": [
													"pm.test(\"Status code is 201\", function () {",
													"    pm.response.to.have.status(201);",
													"});",
													"",
													"var jsonData = pm.response.json();",
													"pm.collectionVariables.set(\"created_api_for_sub\", JSON.stringify(jsonData));",
													"pm.collectionVariables.set(\"created_api_for_sub_id\", jsonData.id);"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"value": "application/json",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n\t\"name\":\"404API_SUB\",\n\t\"version\":\"1.0\",\n\t\"description\":\"API for 'Subscription not found'\",\n\t\"contextPath\":\"/404apisub\",\n\t\"endpoint\":\"http://localhost\"\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{GRAVITEEIO_MGMT_URL}}/apis",
											"host": [
												"{{GRAVITEEIO_MGMT_URL}}"
											],
											"path": [
												"apis"
											]
										}
									},
									"response": []
								},
								{
									"name": "Publish created API",
									"event": [
										{
											"listen": "prerequest",
											"script": {
												"id": "9285d4e7-53ae-40b7-b7a2-66a5a4de0343",
												"exec": [
													"var createdApi_for_sub_toPublish = JSON.parse(pm.collectionVariables.get(\"created_api_for_sub\"));",
													"createdApi_for_sub_toPublish.lifecycle_state='published';",
													"delete createdApi_for_sub_toPublish.id;",
													"delete createdApi_for_sub_toPublish.state;",
													"delete createdApi_for_sub_toPublish.created_at;",
													"delete createdApi_for_sub_toPublish.updated_at;",
													"delete createdApi_for_sub_toPublish.owner;",
													"delete createdApi_for_sub_toPublish.context_path;",
													"pm.collectionVariables.set(\"createdApi_for_sub_toPublish\", JSON.stringify(createdApi_for_sub_toPublish));",
													""
												],
												"type": "text/javascript"
											}
										},
										{
											"listen": "test",
											"script": {
												"id": "0c59f086-f48a-4c73-b234-2ba104356842",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(200);",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "PUT",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"value": "application/json",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{{createdApi_for_sub_toPublish}}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{GRAVITEEIO_MGMT_URL}}/apis/:apiId",
											"host": [
												"{{GRAVITEEIO_MGMT_URL}}"
											],
											"path": [
												"apis",
												":apiId"
											],
											"variable": [
												{
													"key": "apiId",
													"value": "{{created_api_for_sub_id}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "Create Plan for subscription",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "613451cd-7056-4d4f-9ba6-722086674c6a",
												"exec": [
													"pm.test(\"Status code is 201\", function () {",
													"    pm.response.to.have.status(201);",
													"});",
													"",
													"var jsonData = pm.response.json();",
													"pm.collectionVariables.set(\"created_plan_for_sub_id\", jsonData.id);"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"value": "application/json",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n\t\"name\":\"Plan_for_sub\",\n\t\"description\": \"a plan for Subscription not found\"\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{GRAVITEEIO_MGMT_URL}}/apis/:apiId/plans",
											"host": [
												"{{GRAVITEEIO_MGMT_URL}}"
											],
											"path": [
												"apis",
												":apiId",
												"plans"
											],
											"variable": [
												{
													"key": "apiId",
													"value": "{{created_api_for_sub_id}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "Publish created Plan",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "4f3a00fe-488e-4bc2-9c7a-bf2e56f6a0d3",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(200);",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n\t\"name\":\"Plan_for_sub\",\n\t\"description\": \"a plan for Subscription not found\"\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{GRAVITEEIO_MGMT_URL}}/apis/:apiId/plans/:planId/_publish",
											"host": [
												"{{GRAVITEEIO_MGMT_URL}}"
											],
											"path": [
												"apis",
												":apiId",
												"plans",
												":planId",
												"_publish"
											],
											"variable": [
												{
													"key": "apiId",
													"value": "{{created_api_for_sub_id}}"
												},
												{
													"key": "planId",
													"value": "{{created_plan_for_sub_id}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "Create Application for subscription",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "839123b1-30a1-4e1d-8b73-7c4d506f7993",
												"exec": [
													"pm.test(\"Status code is 201\", function () {",
													"    pm.response.to.have.status(201);",
													"});",
													"",
													"var jsonData = pm.response.json();",
													"pm.collectionVariables.set(\"created_application_for_sub_id\", jsonData.id);"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n\t\"name\":\"404ApplicationSub\",\n\t\"description\":\"Application for 'Subscription not found'\"\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{GRAVITEEIO_MGMT_URL}}/applications",
											"host": [
												"{{GRAVITEEIO_MGMT_URL}}"
											],
											"path": [
												"applications"
											]
										}
									},
									"response": []
								},
								{
									"name": "Create Subscription",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "52191874-9fa6-4a13-aa2a-78645de4be27",
												"exec": [
													"pm.test(\"Status code is 201\", function () {",
													"    pm.response.to.have.status(201);",
													"});",
													"",
													"var jsonData = pm.response.json();",
													"pm.collectionVariables.set(\"created_sub_id\", jsonData.id);"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"value": "application/json",
												"type": "text"
											}
										],
										"url": {
											"raw": "{{GRAVITEEIO_MGMT_URL}}/apis/:apiId/subscriptions?application={{created_application_for_sub_id}}&plan={{created_plan_for_sub_id}}",
											"host": [
												"{{GRAVITEEIO_MGMT_URL}}"
											],
											"path": [
												"apis",
												":apiId",
												"subscriptions"
											],
											"query": [
												{
													"key": "application",
													"value": "{{created_application_for_sub_id}}"
												},
												{
													"key": "plan",
													"value": "{{created_plan_for_sub_id}}"
												}
											],
											"variable": [
												{
													"key": "apiId",
													"value": "{{created_api_for_sub_id}}"
												}
											]
										}
									},
									"response": []
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						},
						{
							"name": "Subscription not found",
							"item": [
								{
									"name": "GET /subscriptions/:subscriptionId - Subscription not found",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "3c17b5c5-5a62-425c-b668-8e2dc99789da",
												"exec": [
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{GRAVITEEIO_PORTAL_URL}}/subscriptions/:subscriptionId",
											"host": [
												"{{GRAVITEEIO_PORTAL_URL}}"
											],
											"path": [
												"subscriptions",
												":subscriptionId"
											],
											"variable": [
												{
													"key": "subscriptionId",
													"value": "SUBSCRIPTION"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "POST /subscriptions/:subscriptionId/_close - Subscription not found",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "3dbf80c8-20dc-4a7e-81d2-0f6d694a3213",
												"exec": [
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"url": {
											"raw": "{{GRAVITEEIO_PORTAL_URL}}/subscriptions/:subscriptionId/_close",
											"host": [
												"{{GRAVITEEIO_PORTAL_URL}}"
											],
											"path": [
												"subscriptions",
												":subscriptionId",
												"_close"
											],
											"variable": [
												{
													"key": "subscriptionId",
													"value": "SUBSCRIPTION"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "POST /subscriptions/:subscriptionId/keys/_renew - Subscription not found",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "74918ece-1303-46c2-b9b0-4baae9c5320b",
												"exec": [
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"url": {
											"raw": "{{GRAVITEEIO_PORTAL_URL}}/subscriptions/:subscriptionId/keys/_renew",
											"host": [
												"{{GRAVITEEIO_PORTAL_URL}}"
											],
											"path": [
												"subscriptions",
												":subscriptionId",
												"keys",
												"_renew"
											],
											"variable": [
												{
													"key": "subscriptionId",
													"value": "SUBSCRIPTION"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "POST /subscriptions/:subscriptionId/keys/:keyId/_revoke - Subscription not found",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "7f634321-672a-4219-86c1-6aadc3f90bfd",
												"exec": [
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"url": {
											"raw": "{{GRAVITEEIO_PORTAL_URL}}/subscriptions/:subscriptionId/keys/:keyId/_revoke",
											"host": [
												"{{GRAVITEEIO_PORTAL_URL}}"
											],
											"path": [
												"subscriptions",
												":subscriptionId",
												"keys",
												":keyId",
												"_revoke"
											],
											"variable": [
												{
													"key": "subscriptionId",
													"value": "SUBSCRIPTION"
												},
												{
													"key": "keyId",
													"value": "KEY"
												}
											]
										}
									},
									"response": []
								}
							],
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "ea2c8e3f-e6f6-4cdf-b1a3-5c84d66a5cfb",
										"type": "text/javascript",
										"exec": [
											""
										]
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "03ced3b5-7e32-40ce-893c-5a925dd24134",
										"type": "text/javascript",
										"exec": [
											"pm.test(\"Status code is 404\", function () {",
											"    pm.response.to.have.status(404);",
											"});",
											"pm.test(\"Subscription not found\", function () {",
											"    var jsonData = pm.response.json();",
											"    pm.expect(jsonData.errors[0].message).to.eql(\"Subscription [SUBSCRIPTION] can not be found.\");",
											"});"
										]
									}
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						},
						{
							"name": "Key not found",
							"item": [
								{
									"name": "POST /subscriptions/:subscriptionId/keys/:keyId/_revoke - Subscription not found",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "fce073a3-7946-4e65-bc2c-1a97151b1cf7",
												"exec": [
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"url": {
											"raw": "{{GRAVITEEIO_PORTAL_URL}}/subscriptions/:subscriptionId/keys/:keyId/_revoke",
											"host": [
												"{{GRAVITEEIO_PORTAL_URL}}"
											],
											"path": [
												"subscriptions",
												":subscriptionId",
												"keys",
												":keyId",
												"_revoke"
											],
											"variable": [
												{
													"key": "subscriptionId",
													"value": "{{created_sub_id}}"
												},
												{
													"key": "keyId",
													"value": "KEY"
												}
											]
										}
									},
									"response": []
								}
							],
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "76c7a9a8-a85a-4dea-9bda-5b9cc1e89eb4",
										"type": "text/javascript",
										"exec": [
											""
										]
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "cef1168a-3039-4d89-a20c-c8b4d5893104",
										"type": "text/javascript",
										"exec": [
											"pm.test(\"Status code is 404\", function () {",
											"    pm.response.to.have.status(404);",
											"});",
											"pm.test(\"Subscription not found\", function () {",
											"    var jsonData = pm.response.json();",
											"    pm.expect(jsonData.errors[0].message).to.eql(\"No API Key can be found.\");",
											"});"
										]
									}
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						},
						{
							"name": "-- Clean up --",
							"item": [
								{
									"name": "Close subscription",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "e955a29e-0fb8-4424-9523-6293c7393084",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(200);",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"url": {
											"raw": "{{GRAVITEEIO_MGMT_URL}}/apis/:apiId/subscriptions/:subscriptionId/status?status=CLOSED",
											"host": [
												"{{GRAVITEEIO_MGMT_URL}}"
											],
											"path": [
												"apis",
												":apiId",
												"subscriptions",
												":subscriptionId",
												"status"
											],
											"query": [
												{
													"key": "status",
													"value": "CLOSED"
												}
											],
											"variable": [
												{
													"key": "apiId",
													"value": "{{created_api_for_sub_id}}"
												},
												{
													"key": "subscriptionId",
													"value": "{{created_sub_id}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "Delete created application",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "b779c39c-7747-48f7-9212-273395626963",
												"exec": [
													"pm.test(\"Status code is 204\", function () {",
													"    pm.response.to.have.status(204);",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "DELETE",
										"header": [],
										"url": {
											"raw": "{{GRAVITEEIO_MGMT_URL}}/applications/:applicationId",
											"host": [
												"{{GRAVITEEIO_MGMT_URL}}"
											],
											"path": [
												"applications",
												":applicationId"
											],
											"variable": [
												{
													"key": "applicationId",
													"value": "{{created_application_for_sub_id}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "Close created Plan",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "d12d7193-701e-43d0-9c95-51965042627d",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(200);",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"url": {
											"raw": "{{GRAVITEEIO_MGMT_URL}}/apis/:apiId/plans/:planId/_close",
											"host": [
												"{{GRAVITEEIO_MGMT_URL}}"
											],
											"path": [
												"apis",
												":apiId",
												"plans",
												":planId",
												"_close"
											],
											"variable": [
												{
													"key": "apiId",
													"value": "{{created_api_for_sub_id}}"
												},
												{
													"key": "planId",
													"value": "{{created_plan_for_sub_id}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "Delete created API",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "066197ec-79f4-4e85-b6b7-363ac012ff68",
												"exec": [
													"pm.test(\"Status code is 204\", function () {",
													"    pm.response.to.have.status(204);",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "DELETE",
										"header": [],
										"url": {
											"raw": "{{GRAVITEEIO_MGMT_URL}}/apis/:apiId",
											"host": [
												"{{GRAVITEEIO_MGMT_URL}}"
											],
											"path": [
												"apis",
												":apiId"
											],
											"variable": [
												{
													"key": "apiId",
													"value": "{{created_api_for_sub_id}}"
												}
											]
										}
									},
									"response": []
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						}
					],
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "b116f804-df76-49bd-bfc6-bfb9b86d1452",
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "61c257dd-fd2b-4c84-9c5a-37721ec1b9d0",
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				}
			],
			"protocolProfileBehavior": {}
		},
		{
			"name": "users & user",
			"item": [
				{
					"name": "400",
					"item": [
						{
							"name": "User already exists",
							"item": [
								{
									"name": "-- Prepare --",
									"item": [
										{
											"name": "Create user",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "8d9efdda-e129-4b12-9aa1-2b3d3851e6c1",
														"exec": [
															"pm.test(\"Status code is 200\", function () {",
															"    pm.response.to.have.status(200);",
															"});",
															"",
															"var jsonData = pm.response.json();",
															"pm.collectionVariables.set(\"created_user_id\", jsonData.id);",
															""
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"auth": {
													"type": "basic",
													"basic": [
														{
															"key": "password",
															"value": "admin",
															"type": "string"
														},
														{
															"key": "username",
															"value": "admin",
															"type": "string"
														}
													]
												},
												"method": "POST",
												"header": [
													{
														"key": "Content-Type",
														"name": "Content-Type",
														"value": "application/json",
														"type": "text"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\n\t\"email\": \"postman-test@example.com\"\n}",
													"options": {
														"raw": {
															"language": "json"
														}
													}
												},
												"url": {
													"raw": "{{GRAVITEEIO_MGMT_URL}}/users",
													"host": [
														"{{GRAVITEEIO_MGMT_URL}}"
													],
													"path": [
														"users"
													]
												}
											},
											"response": []
										}
									],
									"protocolProfileBehavior": {},
									"_postman_isSubFolder": true
								},
								{
									"name": "-- Test --",
									"item": [
										{
											"name": "POST /users/registration - user already exist",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "e500c9ae-97ee-49f0-b2c6-e5d2710f2ea3",
														"exec": [
															"pm.test(\"Status code is 400\", function () {",
															"    pm.response.to.have.status(400);",
															"});",
															"",
															"pm.test(\"Invalid email.\", function () {",
															"    var jsonData = pm.response.json();",
															"    pm.expect(jsonData.errors[0].message).to.eql(\"A user [postman-test@example.com] already exists for organization DEFAULT.\");",
															"});"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "POST",
												"header": [
													{
														"key": "Content-Type",
														"name": "Content-Type",
														"type": "text",
														"value": "application/json"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\n\t\"email\": \"postman-test@example.com\"\n}",
													"options": {
														"raw": {
															"language": "json"
														}
													}
												},
												"url": {
													"raw": "{{GRAVITEEIO_PORTAL_URL}}/users/registration",
													"host": [
														"{{GRAVITEEIO_PORTAL_URL}}"
													],
													"path": [
														"users",
														"registration"
													]
												}
											},
											"response": []
										}
									],
									"protocolProfileBehavior": {},
									"_postman_isSubFolder": true
								},
								{
									"name": "-- Clean up --",
									"item": [
										{
											"name": "Delete created user",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "52f63375-d458-4f38-a932-97c0a419a4a0",
														"exec": [
															"pm.test(\"Status code is 204\", function () {",
															"    pm.response.to.have.status(204);",
															"});"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "DELETE",
												"header": [],
												"url": {
													"raw": "{{GRAVITEEIO_MGMT_URL}}/users/:userId",
													"host": [
														"{{GRAVITEEIO_MGMT_URL}}"
													],
													"path": [
														"users",
														":userId"
													],
													"variable": [
														{
															"key": "userId",
															"value": "{{created_user_id}}"
														}
													]
												}
											},
											"response": []
										}
									],
									"protocolProfileBehavior": {},
									"_postman_isSubFolder": true
								}
							],
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "68b0f827-7990-4224-a1b1-69b7c814d3fe",
										"type": "text/javascript",
										"exec": [
											""
										]
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "010db63c-98e3-4c95-92a2-57f58c74ab1b",
										"type": "text/javascript",
										"exec": [
											""
										]
									}
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						},
						{
							"name": "Invalid input",
							"item": [
								{
									"name": "PUT /user - input must not be null",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "989a1eb2-80a9-4ff1-8c6c-049aa34a7f3d",
												"exec": [
													"pm.test(\"Status code is 400\", function () {",
													"    pm.response.to.have.status(400);",
													"});",
													"",
													"pm.test(\"Input must not be null.\", function () {",
													"    var jsonData = pm.response.json();",
													"    pm.expect(jsonData.errors[0].message).to.eql(\"Input must not be null.\");",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "basic",
											"basic": [
												{
													"key": "password",
													"value": "password",
													"type": "string"
												},
												{
													"key": "username",
													"value": "user",
													"type": "string"
												}
											]
										},
										"method": "PUT",
										"header": [],
										"url": {
											"raw": "{{GRAVITEEIO_PORTAL_URL}}/user",
											"host": [
												"{{GRAVITEEIO_PORTAL_URL}}"
											],
											"path": [
												"user"
											]
										}
									},
									"response": []
								},
								{
									"name": "POST /users/registration - input must not be null",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "b5350f6f-1650-40ca-9ee9-9f0e2be285f0",
												"exec": [
													"pm.test(\"Status code is 400\", function () {",
													"    pm.response.to.have.status(400);",
													"});",
													"",
													"pm.test(\"Input must not be null.\", function () {",
													"    var jsonData = pm.response.json();",
													"    pm.expect(jsonData.errors[0].message).to.eql(\"Input must not be null.\");",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"value": "application/json",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{GRAVITEEIO_PORTAL_URL}}/users/registration",
											"host": [
												"{{GRAVITEEIO_PORTAL_URL}}"
											],
											"path": [
												"users",
												"registration"
											]
										}
									},
									"response": []
								},
								{
									"name": "POST /users/registration - missing email",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "cc3fab1a-678c-4a8e-9442-aad0c1354d1c",
												"exec": [
													"pm.test(\"Status code is 400\", function () {",
													"    pm.response.to.have.status(400);",
													"});",
													"",
													"pm.test(\"Invalid email.\", function () {",
													"    var jsonData = pm.response.json();",
													"    pm.expect(jsonData.errors[0].code).to.eql(\"registerUser.arg0.email\");",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n\t\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{GRAVITEEIO_PORTAL_URL}}/users/registration",
											"host": [
												"{{GRAVITEEIO_PORTAL_URL}}"
											],
											"path": [
												"users",
												"registration"
											]
										}
									},
									"response": []
								},
								{
									"name": "POST /users/registration - invalid email",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "f9ed3b39-85fb-4e04-ace7-ea1b793f3400",
												"exec": [
													"pm.test(\"Status code is 400\", function () {",
													"    pm.response.to.have.status(400);",
													"});",
													"",
													"pm.test(\"Invalid email.\", function () {",
													"    var jsonData = pm.response.json();",
													"    pm.expect(jsonData.errors[0].message).to.eql(\"Value [DUMMY EMAIL] is not a valid email.\");",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n\t\"email\": \"DUMMY EMAIL\"\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{GRAVITEEIO_PORTAL_URL}}/users/registration",
											"host": [
												"{{GRAVITEEIO_PORTAL_URL}}"
											],
											"path": [
												"users",
												"registration"
											]
										}
									},
									"response": []
								},
								{
									"name": "POST /users/registration/_finalize - input must not be null",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "b9747ff5-762b-4da6-ad76-8fedadf4924a",
												"exec": [
													"pm.test(\"Status code is 400\", function () {",
													"    pm.response.to.have.status(400);",
													"});",
													"",
													"pm.test(\"Input must not be null.\", function () {",
													"    var jsonData = pm.response.json();",
													"    pm.expect(jsonData.errors[0].message).to.eql(\"Input must not be null.\");",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{GRAVITEEIO_PORTAL_URL}}/users/registration/_finalize",
											"host": [
												"{{GRAVITEEIO_PORTAL_URL}}"
											],
											"path": [
												"users",
												"registration",
												"_finalize"
											]
										}
									},
									"response": []
								},
								{
									"name": "POST /users/registration/_finalize - missing fields",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "9cb36e14-0ab2-43fc-bed3-3df0333d5f33",
												"exec": [
													"pm.test(\"Status code is 400\", function () {",
													"    pm.response.to.have.status(400);",
													"});",
													"",
													"pm.test(\"4 Missing fields.\", function () {",
													"    var jsonData = pm.response.json();",
													"    pm.expect(jsonData.errors.length).to.eql(4);",
													"    ",
													"    var sortedErrors = jsonData.errors.sort(compare);",
													"    pm.expect(sortedErrors[0].code).to.eql('finalizeRegistration.arg0.firstname');",
													"    pm.expect(sortedErrors[1].code).to.eql('finalizeRegistration.arg0.lastname');",
													"    pm.expect(sortedErrors[2].code).to.eql('finalizeRegistration.arg0.password');",
													"    pm.expect(sortedErrors[3].code).to.eql('finalizeRegistration.arg0.token');",
													"});",
													"",
													"",
													"function compare(a, b) {",
													"    // Use toUpperCase() to ignore character casing",
													"  const titleA = a.code.toUpperCase();",
													"  const titleB = b.code.toUpperCase();",
													"",
													"  let comparison = 0;",
													"  if (titleA > titleB) {",
													"    comparison = 1;",
													"  } else if (titleA < titleB) {",
													"    comparison = -1;",
													"  }",
													"  return comparison;",
													"}"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n\t\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{GRAVITEEIO_PORTAL_URL}}/users/registration/_finalize",
											"host": [
												"{{GRAVITEEIO_PORTAL_URL}}"
											],
											"path": [
												"users",
												"registration",
												"_finalize"
											]
										}
									},
									"response": []
								},
								{
									"name": "POST /users/_reset_password - input must not be null",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "c977ae4b-b18a-4084-a18f-384244901f65",
												"exec": [
													"pm.test(\"Status code is 400\", function () {",
													"    pm.response.to.have.status(400);",
													"});",
													"",
													"pm.test(\"Input must not be null.\", function () {",
													"    var jsonData = pm.response.json();",
													"    pm.expect(jsonData.errors[0].message).to.eql(\"Input must not be null.\");",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{GRAVITEEIO_PORTAL_URL}}/users/_reset_password",
											"host": [
												"{{GRAVITEEIO_PORTAL_URL}}"
											],
											"path": [
												"users",
												"_reset_password"
											]
										}
									},
									"response": []
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				},
				{
					"name": "401",
					"item": [
						{
							"name": "PUT /user - input.id != currentUser.id",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "a67c3cc9-54ca-425d-a63a-3b9147ed4dcd",
										"exec": [
											"pm.test(\"Status code is 401\", function () {",
											"    pm.response.to.have.status(401);",
											"});",
											"",
											"pm.test(\"You must be authenticated to access this resource\", function () {",
											"    var jsonData = pm.response.json();",
											"    pm.expect(jsonData.errors[0].message).to.eql(\"You must be authenticated to access this resource\");",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "password",
											"type": "string"
										},
										{
											"key": "username",
											"value": "user",
											"type": "string"
										}
									]
								},
								"method": "PUT",
								"header": [
									{
										"key": "Content-Type",
										"name": "Content-Type",
										"value": "application/json",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n\t\"id\": \"\",\n\t\"avatar\": \"\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{GRAVITEEIO_PORTAL_URL}}/user",
									"host": [
										"{{GRAVITEEIO_PORTAL_URL}}"
									],
									"path": [
										"user"
									]
								}
							},
							"response": []
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				},
				{
					"name": "404",
					"item": [
						{
							"name": "Notification not found",
							"item": [
								{
									"name": "DELETE /user/notifications/:notificationId",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "c13e4fca-92e7-47b1-a27f-885105284805",
												"exec": [
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "DELETE",
										"header": [],
										"url": {
											"raw": "{{GRAVITEEIO_PORTAL_URL}}/user/notifications/:notificationId",
											"host": [
												"{{GRAVITEEIO_PORTAL_URL}}"
											],
											"path": [
												"user",
												"notifications",
												":notificationId"
											],
											"variable": [
												{
													"key": "notificationId",
													"value": "NOTIFICATION"
												}
											]
										}
									},
									"response": []
								}
							],
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "4ad396fa-1e2c-472d-8b87-695e0838aec4",
										"type": "text/javascript",
										"exec": [
											""
										]
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "9152b18b-8a26-4751-8c14-8413379cf368",
										"type": "text/javascript",
										"exec": [
											"pm.test(\"Status code is 404\", function () {",
											"    pm.response.to.have.status(404);",
											"});",
											"pm.test(\"Notification not found\", function () {",
											"    var jsonData = pm.response.json();",
											"    pm.expect(jsonData.errors[0].message).to.eql(\"Portal notification [NOTIFICATION] can not be found.\");",
											"});"
										]
									}
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						}
					],
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "fc5c0bf9-598e-4541-965c-6231445e5afd",
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "e0fa2450-a8cc-4b46-9fc6-eee182ab0046",
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				},
				{
					"name": "503",
					"item": [
						{
							"name": "-- Prepare --",
							"item": [
								{
									"name": "Disable registration service",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "fd3190d1-ee88-402c-a08a-235330e63c36",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(200);",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n\t\"portal\": {\n\t\t\"userCreation\": {\n\t\t\t\"enabled\": false\n\t\t}\n\t}\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{GRAVITEEIO_MGMT_URL}}/portal",
											"host": [
												"{{GRAVITEEIO_MGMT_URL}}"
											],
											"path": [
												"portal"
											]
										}
									},
									"response": []
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						},
						{
							"name": "Registration service not enabled",
							"item": [
								{
									"name": "POST /users/registration",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "7ad043a5-059c-42e1-954a-25fa591c5505",
												"exec": [
													"pm.test(\"Status code is 503\", function () {",
													"    pm.response.to.have.status(503);",
													"});",
													"",
													"pm.test(\"Registration service disabled\", function () {",
													"    var jsonData = pm.response.json();",
													"    pm.expect(jsonData.errors[0].message).to.eql(\"User registration service is unavailable.\");",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n\t\"email\": \"test@example.com\"\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{GRAVITEEIO_PORTAL_URL}}/users/registration",
											"host": [
												"{{GRAVITEEIO_PORTAL_URL}}"
											],
											"path": [
												"users",
												"registration"
											]
										}
									},
									"response": []
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						},
						{
							"name": "-- Clean up --",
							"item": [
								{
									"name": "Enable registration service",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "100054eb-85dc-4de8-91eb-d846f2775bc5",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(200);",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n\t\"portal\": {\n\t\t\"userCreation\": {\n\t\t\t\"enabled\": true\n\t\t}\n\t}\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{GRAVITEEIO_MGMT_URL}}/portal",
											"host": [
												"{{GRAVITEEIO_MGMT_URL}}"
											],
											"path": [
												"portal"
											]
										}
									},
									"response": []
								}
							],
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "cba18c11-da03-499c-8cf2-8776540567c4",
										"type": "text/javascript",
										"exec": [
											""
										]
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "f9c40d6d-8ba9-497c-96c3-26952c37306a",
										"type": "text/javascript",
										"exec": [
											""
										]
									}
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						}
					],
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "878e6974-a218-4ab6-8e79-9ea54b2aba25",
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "20f99b9a-e8e3-497a-a05d-dd0592cd054a",
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				}
			],
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"id": "2f086ace-771e-45f4-bb5b-9d9d0afe9ff0",
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"id": "70225041-758f-4184-96c3-a5ecba9ad787",
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				}
			],
			"protocolProfileBehavior": {}
		}
	],
	"auth": {
		"type": "basic",
		"basic": [
			{
				"key": "password",
				"value": "admin",
				"type": "string"
			},
			{
				"key": "username",
				"value": "admin",
				"type": "string"
			}
		]
	},
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"id": "5b28e8fc-b0b5-45aa-895b-3c8eec95bc2c",
				"type": "text/javascript",
				"exec": [
					"if(!pm.collectionVariables.get('X-Xsrf-Token')) {",
					"    pm.sendRequest({",
					"        url: pm.environment.get('GRAVITEEIO_PORTAL_URL') + '/configuration',",
					"        method: 'GET',",
					"    ",
					"    }, function (err, res) {",
					"        pm.collectionVariables.set('X-Xsrf-Token', res.headers.get('X-Xsrf-Token'));",
					"    });",
					"}",
					"",
					"pm.request.headers.add({key: 'X-Xsrf-Token', value: pm.collectionVariables.get('X-Xsrf-Token') });"
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"id": "74f2c76b-100f-4b39-aa7f-d2ffd7b8b90a",
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"id": "37a62926-e44d-4273-b561-efe020f4aa49",
			"key": "X-Xsrf-Token",
			"value": ""
		},
		{
			"id": "62e702d6-e508-4e92-b53e-d5c77d8a062d",
			"key": "created_api",
			"value": ""
		},
		{
			"id": "bab6aa7e-5293-424c-978d-f3a70ffe8b1e",
			"key": "created_api_id",
			"value": ""
		},
		{
			"id": "c18e3e22-4cc2-4c2f-a37a-fffea88aee8b",
			"key": "created_api_owner_id",
			"value": ""
		},
		{
			"id": "0766e577-b4bb-4014-8d57-7e600c3e6c83",
			"key": "createdApi_toPublish",
			"value": ""
		},
		{
			"id": "3829b7e1-91ba-4374-813d-7371df810dba",
			"key": "created_rating_id",
			"value": ""
		},
		{
			"id": "089d93d2-e7dd-4934-a406-a83c10d4e239",
			"key": "created_application_id",
			"value": ""
		},
		{
			"id": "cf7dd4b9-8537-4e16-a2a5-db9772f5b16f",
			"key": "created_generic_config",
			"value": ""
		},
		{
			"id": "a82adff6-6139-4bc3-962d-a921590362c9",
			"key": "USER_ENV_ROLE",
			"value": ""
		},
		{
			"id": "3d1d4e22-e909-424c-8159-c2b2202ed636",
			"key": "UPDATED_USER_ENV_ROLE",
			"value": ""
		},
		{
			"id": "b45a9353-780c-4820-8e71-a0c6f3756382",
			"key": "created_application",
			"value": ""
		},
		{
			"id": "396ebcd5-d895-4707-adbf-6a24a9a0619a",
			"key": "created_page_id",
			"value": ""
		},
		{
			"id": "fbf31eae-b154-42e5-8915-477760dd53cb",
			"key": "created_page_order",
			"value": ""
		},
		{
			"id": "0272a80a-b480-4238-b7b2-94515a9b3334",
			"key": "created_exclusion_group_id",
			"value": ""
		},
		{
			"id": "b2742be2-8935-4fa8-9bf2-0904ef598576",
			"key": "user_reference",
			"value": ""
		},
		{
			"id": "13708e5f-afad-4fe0-8a3f-c9e3c897b9a8",
			"key": "created_api_for_sub",
			"value": ""
		},
		{
			"id": "a1c885e9-8c0f-4b5d-9094-637d77ec1400",
			"key": "created_api_for_sub_id",
			"value": ""
		},
		{
			"id": "93f8d8fd-481b-4fdb-8720-1069f6d8b8f4",
			"key": "createdApi_for_sub_toPublish",
			"value": ""
		},
		{
			"id": "3adfa1df-2b89-471e-92b7-21bb455e6124",
			"key": "created_plan_for_sub_id",
			"value": ""
		},
		{
			"id": "9a19a5cf-7b49-4760-b543-e0299eb2974a",
			"key": "created_application_for_sub_id",
			"value": ""
		},
		{
			"id": "7ecad570-5429-4909-bb43-f405fd5bfc8c",
			"key": "created_sub_id",
			"value": ""
		},
		{
			"id": "b8575c44-ca18-4016-a00c-cf96012c2f39",
			"key": "first_sub_api_key",
			"value": ""
		},
		{
			"id": "9275e635-6ba6-4067-8325-891a0567137c",
			"key": "created_sec_plan_for_sub_id",
			"value": ""
		},
		{
			"id": "07700893-a43e-40f3-b190-6d8ca62da05d",
			"key": "created_sec_sub_id",
			"value": ""
		},
		{
			"id": "b593d356-5ba8-486f-adc4-e8f7d9eb22af",
			"key": "created_user_id",
			"value": ""
		}
	],
	"protocolProfileBehavior": {}
}
